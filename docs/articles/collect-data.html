<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collect and Clean SPLT Data â€¢ probly</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Collect and Clean SPLT Data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">probly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/age-and-puberty-data.html">Age, Puberty, and Informant Data</a>
    </li>
    <li>
      <a href="../articles/age-learning-association.html">Association of age with learning parameters</a>
    </li>
    <li>
      <a href="../articles/collect-data.html">Collect and Clean SPLT Data</a>
    </li>
    <li>
      <a href="../articles/corr-with-ylg.html">Correspondence with YLG task behavior</a>
    </li>
    <li>
      <a href="../articles/descriptive-statistics.html">Descriptive Statistics for SPLT data</a>
    </li>
    <li>
      <a href="../articles/fit-model-to-participant-data.html">Fit model to participant data</a>
    </li>
    <li>
      <a href="../articles/fsmi-cfa.html">Fundamental Social Motives Confirmatory Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/fsmi-data.html">Retrieve Fundamental Social Motives Data</a>
    </li>
    <li>
      <a href="../articles/test-simple-3l-mv-model.html">Test Simple 3-level Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/test-simulated-data.html">Test Simulated Data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Collect and Clean SPLT Data</h1>
                        <h4 class="author">John Flournoy</h4>
            
            <h4 class="date">2020-04-01</h4>
      
      
      <div class="hidden name"><code>collect-data.Rmd</code></div>

    </div>

    
    
<p>Data from the Social Probabilistic Learning Task was collected from 5 different samples: Community adolescents, foster-care involved adolescents, at-risk adolescents, University of Oregon human subject pool (UOHSP) participants who visited the lab, and UOHSP participants who completed the study online. Data is excluded for any participant who did failed showed a pattern of inattentive responding on the questionnaires and who generated response times that are inconsistent with attentive responding during the task.</p>
<p><strong>Exclusions:</strong> Participants were excluded if they failed three out of four attention checks[^1], completed the self-report questionnaires in less than 30 minutes, and received rewards totaling an amount small enough to be consistent with random responding on the task.</p>
<p>One included response was incompletely saved. One participant completed a different version of the task with a different control condition and was not included.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(readr)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stringr)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">root_dir &lt;-<span class="st"> '~/code_new/probly/extdata/'</span> <span class="co"># This would be '/Volumes/' if you've mounted locally</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">raw_data_dir &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(root_dir, <span class="st">'raw/'</span>)</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">processed_data_dir &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(root_dir, <span class="st">'processed/'</span>)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">conditions &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'HungryThirsty'</span>, <span class="st">'DatingLooking'</span>, <span class="st">'PopularUnpopular'</span>)</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">metacog_condition &lt;-<span class="st"> 'Confidence'</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">file_match_pattern &lt;-<span class="st"> 'split.*csv'</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">col_spec &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span>(</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">    <span class="dt">.default =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_character</a></span>(),</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">    <span class="dt">rt =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">    <span class="dt">key_press =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">    <span class="dt">trial_index =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">    <span class="dt">time_elapsed =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">    <span class="dt">block_duration =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">    <span class="dt">timing_post_trial =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-29" data-line-number="29">    <span class="dt">correct_response =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    <span class="dt">possible_responses =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_number.html">col_number</a></span>(),</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">    <span class="dt">stim_duration =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-32" data-line-number="32">    <span class="dt">feedback_duration =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">    <span class="dt">optimal_response =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-34" data-line-number="34">    <span class="dt">stimindex =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-35" data-line-number="35">    <span class="dt">reward_possible =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-36" data-line-number="36">    <span class="dt">stim_chosen =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-37" data-line-number="37">    <span class="dt">qnum =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-38" data-line-number="38">    <span class="dt">page_num =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-39" data-line-number="39">    <span class="dt">trial_num =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-40" data-line-number="40">    <span class="dt">score_response =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>(),</a>
<a class="sourceLine" id="cb1-41" data-line-number="41">    <span class="dt">response_range =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_number.html">col_number</a></span>(),</a>
<a class="sourceLine" id="cb1-42" data-line-number="42">    <span class="dt">times_viewed =</span> readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span>()</a>
<a class="sourceLine" id="cb1-43" data-line-number="43">)</a>
<a class="sourceLine" id="cb1-44" data-line-number="44"></a>
<a class="sourceLine" id="cb1-45" data-line-number="45">files &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">data_frame</a></span>(<span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="dt">path =</span> raw_data_dir, </a>
<a class="sourceLine" id="cb1-46" data-line-number="46">                                      <span class="dt">pattern =</span> file_match_pattern,</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">                                      <span class="dt">recursive =</span> T)) </a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="co">#&gt; Warning: `data_frame()` is deprecated, use `tibble()`.</span></a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="co">#&gt; This warning is displayed once per session.</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50"></a>
<a class="sourceLine" id="cb1-51" data-line-number="51"><span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Files: '</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(files<span class="op">$</span>file))))</a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="co">#&gt; Files: 328</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"></a>
<a class="sourceLine" id="cb1-54" data-line-number="54">parsed_filenames &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/extract.html">extract</a></span>(</a>
<a class="sourceLine" id="cb1-55" data-line-number="55">    files, </a>
<a class="sourceLine" id="cb1-56" data-line-number="56">    file, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'filename'</span>, <span class="st">'dir'</span>, <span class="st">'id'</span>, <span class="st">'timestamp'</span>), </a>
<a class="sourceLine" id="cb1-57" data-line-number="57">    <span class="st">'(([</span><span class="ch">\\</span><span class="st">w]+/)*split-([0-9]+|bad_pid)[-_]([0-9]+)</span><span class="ch">\\</span><span class="st">.csv)'</span>)</a>
<a class="sourceLine" id="cb1-58" data-line-number="58"></a>
<a class="sourceLine" id="cb1-59" data-line-number="59">splt_data_and_problems &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/do.html">do</a></span>(</a>
<a class="sourceLine" id="cb1-60" data-line-number="60">    dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(</a>
<a class="sourceLine" id="cb1-61" data-line-number="61">        parsed_filenames,</a>
<a class="sourceLine" id="cb1-62" data-line-number="62">        filename, dir, id, timestamp),</a>
<a class="sourceLine" id="cb1-63" data-line-number="63">    {</a>
<a class="sourceLine" id="cb1-64" data-line-number="64">        adf =<span class="st"> </span>readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(raw_data_dir, .<span class="op">$</span>filename[[<span class="dv">1</span>]]), <span class="dt">col_types =</span> col_spec)</a>
<a class="sourceLine" id="cb1-65" data-line-number="65">        prob_adf &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span>(<span class="kw"><a href="https://readr.tidyverse.org/reference/problems.html">problems</a></span>(adf), <span class="kw"><a href="https://dplyr.tidyverse.org/reference/funs.html">funs</a></span>(as.character))</a>
<a class="sourceLine" id="cb1-66" data-line-number="66">        <span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">data_frame</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(adf), <span class="dt">problems =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(prob_adf))</a>
<a class="sourceLine" id="cb1-67" data-line-number="67">    })</a>
<a class="sourceLine" id="cb1-68" data-line-number="68"><span class="co">#&gt; Warning: funs() is soft deprecated as of dplyr 0.8.0</span></a>
<a class="sourceLine" id="cb1-69" data-line-number="69"><span class="co">#&gt; Please use a list of either functions or lambdas: </span></a>
<a class="sourceLine" id="cb1-70" data-line-number="70"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-71" data-line-number="71"><span class="co">#&gt;   # Simple named list: </span></a>
<a class="sourceLine" id="cb1-72" data-line-number="72"><span class="co">#&gt;   list(mean = mean, median = median)</span></a>
<a class="sourceLine" id="cb1-73" data-line-number="73"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-74" data-line-number="74"><span class="co">#&gt;   # Auto named with `tibble::lst()`: </span></a>
<a class="sourceLine" id="cb1-75" data-line-number="75"><span class="co">#&gt;   tibble::lst(mean, median)</span></a>
<a class="sourceLine" id="cb1-76" data-line-number="76"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-77" data-line-number="77"><span class="co">#&gt;   # Using lambdas</span></a>
<a class="sourceLine" id="cb1-78" data-line-number="78"><span class="co">#&gt;   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</span></a>
<a class="sourceLine" id="cb1-79" data-line-number="79"><span class="co">#&gt; This warning is displayed once per session.</span></a>
<a class="sourceLine" id="cb1-80" data-line-number="80"><span class="co">#&gt; Warning: The following named parsers don't match the column names: stimindex,</span></a>
<a class="sourceLine" id="cb1-81" data-line-number="81"><span class="co">#&gt; qnum, page_num, trial_num, score_response, response_range, times_viewed</span></a>
<a class="sourceLine" id="cb1-82" data-line-number="82"></a>
<a class="sourceLine" id="cb1-83" data-line-number="83">splt_data_and_problems<span class="op">$</span>.id &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(splt_data_and_problems)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1-84" data-line-number="84"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(splt_data_and_problems<span class="op">$</span>data) &lt;-<span class="st"> </span>splt_data_and_problems<span class="op">$</span>.id</a>
<a class="sourceLine" id="cb1-85" data-line-number="85"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(splt_data_and_problems<span class="op">$</span>problems) &lt;-<span class="st"> </span>splt_data_and_problems<span class="op">$</span>.id</a>
<a class="sourceLine" id="cb1-86" data-line-number="86"></a>
<a class="sourceLine" id="cb1-87" data-line-number="87">splt_data &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(</a>
<a class="sourceLine" id="cb1-88" data-line-number="88">    <span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(splt_data_and_problems<span class="op">$</span>data, <span class="dt">.id =</span> <span class="st">'.id'</span>),</a>
<a class="sourceLine" id="cb1-89" data-line-number="89">    splt_data_and_problems[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'.id'</span>, <span class="st">'filename'</span>, <span class="st">'dir'</span>, <span class="st">'id'</span>, <span class="st">'timestamp'</span>)])</a>
<a class="sourceLine" id="cb1-90" data-line-number="90"><span class="co">#&gt; Joining, by = ".id"</span></a>
<a class="sourceLine" id="cb1-91" data-line-number="91">splt_problems &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(</a>
<a class="sourceLine" id="cb1-92" data-line-number="92">    <span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(splt_data_and_problems<span class="op">$</span>problems, <span class="dt">.id =</span> <span class="st">'.id'</span>),</a>
<a class="sourceLine" id="cb1-93" data-line-number="93">    splt_data_and_problems[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'.id'</span>, <span class="st">'filename'</span>, <span class="st">'dir'</span>, <span class="st">'id'</span>, <span class="st">'timestamp'</span>)])</a>
<a class="sourceLine" id="cb1-94" data-line-number="94"><span class="co">#&gt; Joining, by = ".id"</span></a>
<a class="sourceLine" id="cb1-95" data-line-number="95"></a>
<a class="sourceLine" id="cb1-96" data-line-number="96">splt_crunched &lt;-<span class="st"> </span>splt_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-97" data-line-number="97"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>((trial_id <span class="op">==</span><span class="st"> 'stim'</span> <span class="op">&amp;</span><span class="st"> </span>(key_press<span class="op">&gt;</span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>key_press<span class="op">==-</span><span class="dv">1</span>)) <span class="op">|</span><span class="st"> </span>(trial_id <span class="op">==</span><span class="st"> 'metacog'</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-98" data-line-number="98"><span class="st">    </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/extract.html">extract</a></span>(image, </a>
<a class="sourceLine" id="cb1-99" data-line-number="99">                   <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'stim_image'</span>, <span class="st">'sex'</span>), </a>
<a class="sourceLine" id="cb1-100" data-line-number="100">                   <span class="st">'.*/(([fma])_f42887_e_[0-9]{3}</span><span class="ch">\\</span><span class="st">.png)'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-101" data-line-number="101"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">correcttrue =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(key_press <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>, <span class="ot">NA</span>, <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(correct <span class="op">==</span><span class="st"> 'true'</span>)),</a>
<a class="sourceLine" id="cb1-102" data-line-number="102">                  <span class="dt">outcome =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(feedback, reward_possible, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1-103" data-line-number="103">                  <span class="dt">pressed_r =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">37</span><span class="st">`</span> =<span class="st"> </span><span class="dv">0</span>,<span class="st">`</span><span class="dt">39</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span>)[<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(key_press)],</a>
<a class="sourceLine" id="cb1-104" data-line-number="104">                  <span class="dt">correct_r =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">37</span><span class="st">`</span> =<span class="st"> </span><span class="dv">0</span>,<span class="st">`</span><span class="dt">39</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span>)[<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(correct_response)]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-105" data-line-number="105"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-106" data-line-number="106"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">proportion =</span> condition, </a>
<a class="sourceLine" id="cb1-107" data-line-number="107">                  <span class="dt">condition =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span>(context, <span class="st">'_'</span>))), <span class="dt">collapse =</span> <span class="st">''</span>), </a>
<a class="sourceLine" id="cb1-108" data-line-number="108">                  <span class="dt">condition =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(trial_id <span class="op">==</span><span class="st"> 'metacog'</span>, <span class="st">'Confidence'</span>, condition),</a>
<a class="sourceLine" id="cb1-109" data-line-number="109">                  <span class="dt">correcttrue =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(trial_id <span class="op">==</span><span class="st"> 'metacog'</span>, </a>
<a class="sourceLine" id="cb1-110" data-line-number="110">                                     <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(score_response), correcttrue)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-111" data-line-number="111"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(condition <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(conditions, metacog_condition)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-112" data-line-number="112"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(filename, id, condition) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-113" data-line-number="113"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">condition_trial_index =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>(),</a>
<a class="sourceLine" id="cb1-114" data-line-number="114">                  <span class="dt">block =</span> ((condition_trial_index<span class="dv">-1</span>) <span class="op">%/%</span><span class="st"> </span><span class="dv">16</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1-115" data-line-number="115">                  <span class="dt">dir =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(dir), <span class="st">'/'</span>, dir),</a>
<a class="sourceLine" id="cb1-116" data-line-number="116">                  <span class="dt">sample =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(dir <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'yads/'</span>, <span class="st">'yads_online/'</span>),</a>
<a class="sourceLine" id="cb1-117" data-line-number="117">                                  <span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">'/'</span>, <span class="st">''</span>, dir),</a>
<a class="sourceLine" id="cb1-118" data-line-number="118">                                  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'TDS2'</span>, <span class="st">'TDS2'</span>, <span class="st">'TDS1'</span>, <span class="st">'TDS3'</span>)[<span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(id)<span class="op">/</span><span class="dv">100</span>)])) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-119" data-line-number="119"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-120" data-line-number="120"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(id, dir, filename, sample,</a>
<a class="sourceLine" id="cb1-121" data-line-number="121">                  correcttrue, pressed_r, outcome, </a>
<a class="sourceLine" id="cb1-122" data-line-number="122">                  correct_r, reward_possible,</a>
<a class="sourceLine" id="cb1-123" data-line-number="123">                  condition, condition_trial_index, </a>
<a class="sourceLine" id="cb1-124" data-line-number="124">                  sex, stim_image, </a>
<a class="sourceLine" id="cb1-125" data-line-number="125">                  trial_index, block, proportion, </a>
<a class="sourceLine" id="cb1-126" data-line-number="126">                  rt, time_elapsed, timestamp)</a>
<a class="sourceLine" id="cb1-127" data-line-number="127"><span class="co">#&gt; Warning: Grouping rowwise data frame strips rowwise nature</span></a>
<a class="sourceLine" id="cb1-128" data-line-number="128"></a>
<a class="sourceLine" id="cb1-129" data-line-number="129">splt_crunched &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(</a>
<a class="sourceLine" id="cb1-130" data-line-number="130">    <span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(splt_crunched, filename),</a>
<a class="sourceLine" id="cb1-131" data-line-number="131">    <span class="dt">date_time_completed =</span> probly<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/probly/man/get_date_from_epoch_ms.html">get_date_from_epoch_ms</a></span>(</a>
<a class="sourceLine" id="cb1-132" data-line-number="132">        <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(timestamp) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">1</span>, <span class="dv">-10</span>, <span class="dv">10</span>)<span class="op">*</span><span class="dv">24</span><span class="op">*</span><span class="dv">60</span><span class="op">*</span><span class="dv">60</span><span class="op">*</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1-133" data-line-number="133">)</a>
<a class="sourceLine" id="cb1-134" data-line-number="134"></a>
<a class="sourceLine" id="cb1-135" data-line-number="135">participant_anon_id &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="dt">file =</span> anon_id_filename)</a>
<a class="sourceLine" id="cb1-136" data-line-number="136"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb1-137" data-line-number="137"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb1-138" data-line-number="138"><span class="co">#&gt;   id = col_character(),</span></a>
<a class="sourceLine" id="cb1-139" data-line-number="139"><span class="co">#&gt;   sample = col_character(),</span></a>
<a class="sourceLine" id="cb1-140" data-line-number="140"><span class="co">#&gt;   anon_id = col_double(),</span></a>
<a class="sourceLine" id="cb1-141" data-line-number="141"><span class="co">#&gt;   anon_sample = col_character(),</span></a>
<a class="sourceLine" id="cb1-142" data-line-number="142"><span class="co">#&gt;   exclude = col_double(),</span></a>
<a class="sourceLine" id="cb1-143" data-line-number="143"><span class="co">#&gt;   reason = col_character()</span></a>
<a class="sourceLine" id="cb1-144" data-line-number="144"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb1-145" data-line-number="145">participant_anon_id &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(participant_anon_id, <span class="dt">exclude =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(exclude), <span class="dv">0</span>, exclude))</a>
<a class="sourceLine" id="cb1-146" data-line-number="146">splt_crunched &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(splt_crunched, participant_anon_id, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'id'</span>, <span class="st">'sample'</span>))</a>
<a class="sourceLine" id="cb1-147" data-line-number="147">splt_crunched &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(splt_crunched, <span class="op">!</span>exclude)</a>
<a class="sourceLine" id="cb1-148" data-line-number="148">splt_crunched &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(splt_crunched, <span class="dt">id =</span> anon_id, <span class="dt">sample =</span> anon_sample)</a>
<a class="sourceLine" id="cb1-149" data-line-number="149">splt_crunched &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(splt_crunched, <span class="op">-</span>anon_id, <span class="op">-</span>anon_sample)</a>
<a class="sourceLine" id="cb1-150" data-line-number="150"></a>
<a class="sourceLine" id="cb1-151" data-line-number="151">metacog_clean &lt;-<span class="st"> </span>splt_crunched <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-152" data-line-number="152"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-153" data-line-number="153"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>sex, <span class="op">-</span>stim_image) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-154" data-line-number="154"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(condition <span class="op">==</span><span class="st"> </span>metacog_condition,</a>
<a class="sourceLine" id="cb1-155" data-line-number="155">                  <span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(correcttrue)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-156" data-line-number="156"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">block=</span>(condition_trial_index<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-157" data-line-number="157"><span class="st">    </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span>(condition, correcttrue) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-158" data-line-number="158"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">confidence=</span>Confidence) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-159" data-line-number="159"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(sample, id, block, confidence)</a>
<a class="sourceLine" id="cb1-160" data-line-number="160"></a>
<a class="sourceLine" id="cb1-161" data-line-number="161">splt_clean &lt;-<span class="st"> </span>splt_crunched <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-162" data-line-number="162"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-163" data-line-number="163"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(condition <span class="op">!=</span><span class="st"> </span>metacog_condition) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-164" data-line-number="164"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">condition =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(condition, </a>
<a class="sourceLine" id="cb1-165" data-line-number="165">                                     <span class="dt">levels =</span> conditions, </a>
<a class="sourceLine" id="cb1-166" data-line-number="166">                                     <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span>(conditions))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-167" data-line-number="167"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>exclude, <span class="op">-</span>filename, <span class="op">-</span>timestamp) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-168" data-line-number="168"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(sample, id, trial_index)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#Write the data</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">splt &lt;-<span class="st"> </span>splt_clean</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">splt_confidence &lt;-<span class="st"> </span>metacog_clean</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">devtools<span class="op">::</span><span class="kw">use_data</span>(splt, splt_confidence)</a></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Flournoy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
