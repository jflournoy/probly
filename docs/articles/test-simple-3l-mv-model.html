<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test Simple 3-level Multivariate Normal Model • probly</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Test Simple 3-level Multivariate Normal Model">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">probly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/age-and-puberty-data.html">Age, Puberty, and Informant Data</a>
    </li>
    <li>
      <a href="../articles/age-learning-association.html">Association of age with learning parameters</a>
    </li>
    <li>
      <a href="../articles/collect-data.html">Collect and Clean SPLT Data</a>
    </li>
    <li>
      <a href="../articles/corr-with-ylg.html">Correspondence with YLG task behavior</a>
    </li>
    <li>
      <a href="../articles/descriptive-statistics.html">Descriptive Statistics for SPLT data</a>
    </li>
    <li>
      <a href="../articles/fit-model-to-participant-data.html">Fit model to participant data</a>
    </li>
    <li>
      <a href="../articles/fsmi-cfa.html">Fundamental Social Motives Confirmatory Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/fsmi-data.html">Retrieve Fundamental Social Motives Data</a>
    </li>
    <li>
      <a href="../articles/test-simple-3l-mv-model.html">Test Simple 3-level Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/test-simulated-data.html">Test Simulated Data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Test Simple 3-level Multivariate Normal Model</h1>
                        <h4 class="author">John Flournoy</h4>
            
            <h4 class="date">2020-04-01</h4>
      
      
      <div class="hidden name"><code>test-simple-3l-mv-model.Rmd</code></div>

    </div>

    
    
<p>The goal of this vignette is to demonstrate that the multivariate normal model that I will use for each parameter in the learning model is able to be estimated accurately and without prohibitively excessive computer time. In these examples I show that accounting for the nested structure of data with observations nested in participants nested in sample may be important. I also show that the 3-level model using both centered and non-centered parameterization of the 3rd level group means gives similar results. Finally, it may be helpful to note that the centered (that is, standard) parameterization finishes sampling in much less time than the non-centered model.</p>
<p>Generate data where there are 3 conditions, and individual variation in probability of choosing ‘left’ for each condition. Set the mean probability of left for each condition to values in <code>beta_mu</code> below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(probly)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">150319</span><span class="op">/</span><span class="dv">2018</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">j &lt;-<span class="st"> </span><span class="dv">300</span> <span class="co">#number of subjects</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">t &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#number of trials</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">g &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of subsamples</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">c &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">#number of conditions</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">n &lt;-<span class="st"> </span>t<span class="op">*</span>c<span class="op">*</span>j <span class="co">#number of observations</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">gg &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span>g, <span class="dt">size =</span> j, <span class="dt">replace =</span> T) <span class="co">#group IDs</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">hyper_gamma_mu &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#The mean population effect</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">hyper_gamma_sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">gamma_mu &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(c<span class="op">*</span>g, hyper_gamma_mu, hyper_gamma_sigma), <span class="dt">nrow =</span> g, <span class="dt">byrow =</span> T) <span class="co">#specific sample mean effects</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">gamma_sigma &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="fl">.2</span>, <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">      <span class="fl">.2</span>, <span class="dv">1</span>, <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">      <span class="fl">.2</span>, <span class="fl">.2</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">    <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> T</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">) <span class="co">#correlation among random effects at between individuals in the same sample</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"></a>
<a class="sourceLine" id="cb1-20" data-line-number="20">beta_j &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(gamma_mu[gg,], <span class="dv">1</span>, <span class="cf">function</span>(mu) {MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span>(<span class="dv">1</span>, mu, gamma_sigma)}))</a>
<a class="sourceLine" id="cb1-21" data-line-number="21"></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">beta_j_df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(beta_j)</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">beta_j_df<span class="op">$</span>b0 &lt;-<span class="st"> </span>beta_j_df[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">beta_j_df<span class="op">$</span>b1 &lt;-<span class="st"> </span>beta_j_df[,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>beta_j_df[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">beta_j_df<span class="op">$</span>b2 &lt;-<span class="st"> </span>beta_j_df[,<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>beta_j_df[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb1-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(beta_j_df)</a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt;        V1                V2                V3                b0         </span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt;  Min.   :-4.0175   Min.   :-4.2855   Min.   :-2.4245   Min.   :-4.0175  </span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt;  1st Qu.:-1.9721   1st Qu.:-1.2661   1st Qu.: 0.0265   1st Qu.:-1.9721  </span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#&gt;  Median :-1.2353   Median :-0.4610   Median : 0.8560   Median :-1.2353  </span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#&gt;  Mean   :-1.2108   Mean   :-0.3778   Mean   : 0.8281   Mean   :-1.2108  </span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt;  3rd Qu.:-0.5176   3rd Qu.: 0.5260   3rd Qu.: 1.6584   3rd Qu.:-0.5176  </span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt;  Max.   : 2.5766   Max.   : 3.1939   Max.   : 3.5379   Max.   : 2.5766  </span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt;        b1                b2        </span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt;  Min.   :-3.1894   Min.   :-2.186  </span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt;  1st Qu.:-0.3325   1st Qu.: 1.077  </span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt;  Median : 0.7406   Median : 2.104  </span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt;  Mean   : 0.8330   Mean   : 2.039  </span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt;  3rd Qu.: 1.9007   3rd Qu.: 3.065  </span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="co">#&gt;  Max.   : 5.5439   Max.   : 5.840</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(beta_j_df[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="co">#&gt;           V1         V2         V3</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="co">#&gt; V1 1.0000000  0.1594171  0.2178985</span></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co">#&gt; V2 0.1594171  1.0000000 -0.1485011</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46"><span class="co">#&gt; V3 0.2178985 -0.1485011  1.0000000</span></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(beta_j_df[,<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>])</a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="co">#&gt;            b0         b1         b2</span></a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="co">#&gt; b0  1.0000000 -0.5765408 -0.6214389</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="co">#&gt; b1 -0.5765408  1.0000000  0.2365417</span></a>
<a class="sourceLine" id="cb1-51" data-line-number="51"><span class="co">#&gt; b2 -0.6214389  0.2365417  1.0000000</span></a>
<a class="sourceLine" id="cb1-52" data-line-number="52"></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">1</span><span class="op">:</span>g, <span class="cf">function</span>(grp) <span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(beta_j_df[gg <span class="op">==</span><span class="st"> </span>grp,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb1-54" data-line-number="54"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb1-55" data-line-number="55"><span class="co">#&gt;           V1        V2        V3</span></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="co">#&gt; V1 1.0000000 0.1166829 0.3220135</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57"><span class="co">#&gt; V2 0.1166829 1.0000000 0.1205976</span></a>
<a class="sourceLine" id="cb1-58" data-line-number="58"><span class="co">#&gt; V3 0.3220135 0.1205976 1.0000000</span></a>
<a class="sourceLine" id="cb1-59" data-line-number="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-60" data-line-number="60"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"><span class="co">#&gt;           V1        V2        V3</span></a>
<a class="sourceLine" id="cb1-62" data-line-number="62"><span class="co">#&gt; V1 1.0000000 0.2920232 0.2489808</span></a>
<a class="sourceLine" id="cb1-63" data-line-number="63"><span class="co">#&gt; V2 0.2920232 1.0000000 0.2845323</span></a>
<a class="sourceLine" id="cb1-64" data-line-number="64"><span class="co">#&gt; V3 0.2489808 0.2845323 1.0000000</span></a>
<a class="sourceLine" id="cb1-65" data-line-number="65"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-66" data-line-number="66"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb1-67" data-line-number="67"><span class="co">#&gt;           V1        V2        V3</span></a>
<a class="sourceLine" id="cb1-68" data-line-number="68"><span class="co">#&gt; V1 1.0000000 0.2526182 0.1727907</span></a>
<a class="sourceLine" id="cb1-69" data-line-number="69"><span class="co">#&gt; V2 0.2526182 1.0000000 0.4202191</span></a>
<a class="sourceLine" id="cb1-70" data-line-number="70"><span class="co">#&gt; V3 0.1727907 0.4202191 1.0000000</span></a>
<a class="sourceLine" id="cb1-71" data-line-number="71"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-72" data-line-number="72"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb1-73" data-line-number="73"><span class="co">#&gt;           V1         V2         V3</span></a>
<a class="sourceLine" id="cb1-74" data-line-number="74"><span class="co">#&gt; V1 1.0000000 0.19792835 0.42980543</span></a>
<a class="sourceLine" id="cb1-75" data-line-number="75"><span class="co">#&gt; V2 0.1979284 1.00000000 0.07651541</span></a>
<a class="sourceLine" id="cb1-76" data-line-number="76"><span class="co">#&gt; V3 0.4298054 0.07651541 1.00000000</span></a>
<a class="sourceLine" id="cb1-77" data-line-number="77"></a>
<a class="sourceLine" id="cb1-78" data-line-number="78">dd &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">id =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="dv">1</span><span class="op">:</span>j),</a>
<a class="sourceLine" id="cb1-79" data-line-number="79">                 <span class="dt">grp =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(gg),</a>
<a class="sourceLine" id="cb1-80" data-line-number="80">                 <span class="dt">condition =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> n<span class="op">/</span>j<span class="op">/</span><span class="dv">3</span>), <span class="dt">each =</span> j)))</a>
<a class="sourceLine" id="cb1-81" data-line-number="81"></a>
<a class="sourceLine" id="cb1-82" data-line-number="82">design &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>id<span class="op">:</span>condition, dd)</a>
<a class="sourceLine" id="cb1-83" data-line-number="83"></a>
<a class="sourceLine" id="cb1-84" data-line-number="84">dd<span class="op">$</span>theta &lt;-<span class="st">  </span>design <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(beta_j)</a>
<a class="sourceLine" id="cb1-85" data-line-number="85"></a>
<a class="sourceLine" id="cb1-86" data-line-number="86">dd<span class="op">$</span>p &lt;-<span class="st"> </span>arm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/arm/man/invlogit.html">invlogit</a></span>(dd<span class="op">$</span>theta)</a>
<a class="sourceLine" id="cb1-87" data-line-number="87">dd<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(dd)[<span class="dv">1</span>], <span class="dv">1</span>, dd<span class="op">$</span>p)</a>
<a class="sourceLine" id="cb1-88" data-line-number="88"></a>
<a class="sourceLine" id="cb1-89" data-line-number="89">dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(</a>
<a class="sourceLine" id="cb1-90" data-line-number="90">    dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(dd, grp), </a>
<a class="sourceLine" id="cb1-91" data-line-number="91">    <span class="dt">N =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(id)))</a>
<a class="sourceLine" id="cb1-92" data-line-number="92"><span class="co">#&gt; # A tibble: 4 x 2</span></a>
<a class="sourceLine" id="cb1-93" data-line-number="93"><span class="co">#&gt;   grp       N</span></a>
<a class="sourceLine" id="cb1-94" data-line-number="94"><span class="co">#&gt;   &lt;fct&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb1-95" data-line-number="95"><span class="co">#&gt; 1 1        77</span></a>
<a class="sourceLine" id="cb1-96" data-line-number="96"><span class="co">#&gt; 2 2        69</span></a>
<a class="sourceLine" id="cb1-97" data-line-number="97"><span class="co">#&gt; 3 3        79</span></a>
<a class="sourceLine" id="cb1-98" data-line-number="98"><span class="co">#&gt; 4 4        75</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; Loading required package: Matrix</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(brms)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; Loading required package: Rcpp</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; Loading 'brms' package (version 2.11.1). Useful instructions</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; can be found by typing help('brms'). A more detailed introduction</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; to the package is available through vignette('brms_overview').</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; Attaching package: 'brms'</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; The following object is masked from 'package:lme4':</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;     ngrps</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rstan)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; Loading required package: StanHeaders</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; Loading required package: ggplot2</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; rstan (Version 2.19.3, GitRev: 2e1f913d3ca3)</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; options(mc.cores = parallel::detectCores()).</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; To avoid recompilation of unchanged Stan programs, we recommend calling</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; rstan_options(auto_write = TRUE)</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(future)</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="kw"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span>(<span class="st">'multiprocess'</span>)</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; Warning: [ONE-TIME </span><span class="al">WARNING</span><span class="co">] Forked processing ('multicore') is disabled</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; in future (&gt;= 1.13.0) when running R from RStudio, because it is</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; considered unstable. Because of this, plan("multicore") will fall</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; back to plan("sequential"), and plan("multiprocess") will fall back to</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; plan("multisession") - not plan("multicore") as in the past. For more details,</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; how to control forked processing or not, and how to silence this warning in</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; future R sessions, see ?future::supportsMulticore</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"></a>
<a class="sourceLine" id="cb2-31" data-line-number="31">glm_fit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition, <span class="dt">data =</span> dd, <span class="dt">family =</span> <span class="st">'binomial'</span>)</a>
<a class="sourceLine" id="cb2-32" data-line-number="32"></a>
<a class="sourceLine" id="cb2-33" data-line-number="33">lme4_fit_fn &lt;-<span class="st"> '/data/jflournoy/split/probly/lme4_test_fit.RDS'</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34">lme4_fit_future &lt;-<span class="st"> </span>future<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/future/man/future.html">future</a></span>(</a>
<a class="sourceLine" id="cb2-35" data-line-number="35">    <span class="kw"><a href="../reference/CachedFit.html">CachedFit</a></span>(</a>
<a class="sourceLine" id="cb2-36" data-line-number="36">        {</a>
<a class="sourceLine" id="cb2-37" data-line-number="37">            lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">|</span><span class="st"> </span>grp<span class="op">/</span>id), <span class="dt">data =</span> dd, <span class="dt">family =</span> <span class="st">'binomial'</span>)</a>
<a class="sourceLine" id="cb2-38" data-line-number="38">        },</a>
<a class="sourceLine" id="cb2-39" data-line-number="39">        <span class="dt">rds_filename =</span> lme4_fit_fn))</a>
<a class="sourceLine" id="cb2-40" data-line-number="40"></a>
<a class="sourceLine" id="cb2-41" data-line-number="41">lme4_fit_2L_fn &lt;-<span class="st"> '/data/jflournoy/split/probly/lme4_test_fit_2L.RDS'</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42">lme4_fit_2L_future &lt;-<span class="st"> </span>future<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/future/man/future.html">future</a></span>(</a>
<a class="sourceLine" id="cb2-43" data-line-number="43">    <span class="kw"><a href="../reference/CachedFit.html">CachedFit</a></span>(</a>
<a class="sourceLine" id="cb2-44" data-line-number="44">        {</a>
<a class="sourceLine" id="cb2-45" data-line-number="45">            lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">|</span><span class="st"> </span>id), <span class="dt">data =</span> dd, <span class="dt">family =</span> <span class="st">'binomial'</span>)</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">        },</a>
<a class="sourceLine" id="cb2-47" data-line-number="47">        <span class="dt">rds_filename =</span> lme4_fit_2L_fn))</a>
<a class="sourceLine" id="cb2-48" data-line-number="48"></a>
<a class="sourceLine" id="cb2-49" data-line-number="49">lme4_fit_2L_2rx_fn &lt;-<span class="st"> '/data/jflournoy/split/probly/lme4_test_fit_2L_2rx.RDS'</span></a>
<a class="sourceLine" id="cb2-50" data-line-number="50">lme4_fit_2L_2rx_future &lt;-<span class="st"> </span>future<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/future/man/future.html">future</a></span>(</a>
<a class="sourceLine" id="cb2-51" data-line-number="51">    <span class="kw"><a href="../reference/CachedFit.html">CachedFit</a></span>(</a>
<a class="sourceLine" id="cb2-52" data-line-number="52">        {</a>
<a class="sourceLine" id="cb2-53" data-line-number="53">            lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">|</span><span class="st"> </span>id) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">|</span><span class="st"> </span>grp), </a>
<a class="sourceLine" id="cb2-54" data-line-number="54">                        <span class="dt">data =</span> dd, <span class="dt">family =</span> <span class="st">'binomial'</span>)</a>
<a class="sourceLine" id="cb2-55" data-line-number="55">        },</a>
<a class="sourceLine" id="cb2-56" data-line-number="56">        <span class="dt">rds_filename =</span> lme4_fit_2L_2rx_fn))</a>
<a class="sourceLine" id="cb2-57" data-line-number="57"></a>
<a class="sourceLine" id="cb2-58" data-line-number="58"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(glm_fit)</a>
<a class="sourceLine" id="cb2-59" data-line-number="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-60" data-line-number="60"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb2-61" data-line-number="61"><span class="co">#&gt; glm(formula = y ~ 1 + condition, family = "binomial", data = dd)</span></a>
<a class="sourceLine" id="cb2-62" data-line-number="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-63" data-line-number="63"><span class="co">#&gt; Deviance Residuals: </span></a>
<a class="sourceLine" id="cb2-64" data-line-number="64"><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></a>
<a class="sourceLine" id="cb2-65" data-line-number="65"><span class="co">#&gt; -1.4667  -1.0552  -0.7976   0.9134   1.6127  </span></a>
<a class="sourceLine" id="cb2-66" data-line-number="66"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-67" data-line-number="67"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb2-68" data-line-number="68"><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></a>
<a class="sourceLine" id="cb2-69" data-line-number="69"><span class="co">#&gt; (Intercept) -0.98231    0.01297  -75.75   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb2-70" data-line-number="70"><span class="co">#&gt; condition2   0.68780    0.01745   39.42   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb2-71" data-line-number="71"><span class="co">#&gt; condition3   1.64071    0.01779   92.23   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb2-72" data-line-number="72"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb2-73" data-line-number="73"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb2-74" data-line-number="74"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-75" data-line-number="75"><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></a>
<a class="sourceLine" id="cb2-76" data-line-number="76"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-77" data-line-number="77"><span class="co">#&gt;     Null deviance: 123961  on 89999  degrees of freedom</span></a>
<a class="sourceLine" id="cb2-78" data-line-number="78"><span class="co">#&gt; Residual deviance: 114591  on 89997  degrees of freedom</span></a>
<a class="sourceLine" id="cb2-79" data-line-number="79"><span class="co">#&gt; AIC: 114597</span></a>
<a class="sourceLine" id="cb2-80" data-line-number="80"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-81" data-line-number="81"><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></a>
<a class="sourceLine" id="cb2-82" data-line-number="82"></a>
<a class="sourceLine" id="cb2-83" data-line-number="83"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(</a>
<a class="sourceLine" id="cb2-84" data-line-number="84">    <span class="dt">means =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(dd, condition), <span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(y))[,<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb2-85" data-line-number="85">    <span class="dt">glm_coef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(glm_fit)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(glm_fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(glm_fit)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)])),</a>
<a class="sourceLine" id="cb2-86" data-line-number="86">    <span class="dt">glm_p =</span> arm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/arm/man/invlogit.html">invlogit</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(glm_fit)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(glm_fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(glm_fit)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)]))))</a>
<a class="sourceLine" id="cb2-87" data-line-number="87"><span class="co">#&gt;               mean1      mean2     mean3</span></a>
<a class="sourceLine" id="cb2-88" data-line-number="88"><span class="co">#&gt; means     0.2724333  0.4269000 0.6589000</span></a>
<a class="sourceLine" id="cb2-89" data-line-number="89"><span class="co">#&gt; glm_coef -0.9823117 -0.2945104 0.6583961</span></a>
<a class="sourceLine" id="cb2-90" data-line-number="90"><span class="co">#&gt; glm_p     0.2724333  0.4269000 0.6589000</span></a>
<a class="sourceLine" id="cb2-91" data-line-number="91"></a>
<a class="sourceLine" id="cb2-92" data-line-number="92"><span class="kw"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-93" data-line-number="93"><span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/pkg/future/man/resolved.html">resolved</a></span>(lme4_fit_future)){</a>
<a class="sourceLine" id="cb2-94" data-line-number="94">    lme4_fit &lt;-<span class="st"> </span>future<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/future/man/value.html">value</a></span>(lme4_fit_future)</a>
<a class="sourceLine" id="cb2-95" data-line-number="95">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(lme4_fit))</a>
<a class="sourceLine" id="cb2-96" data-line-number="96">    <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(</a>
<a class="sourceLine" id="cb2-97" data-line-number="97">        <span class="dt">means =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(dd, condition), <span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(y))[,<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb2-98" data-line-number="98">        <span class="dt">lme4_coef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)])),</a>
<a class="sourceLine" id="cb2-99" data-line-number="99">        <span class="dt">lme4_p =</span> arm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/arm/man/invlogit.html">invlogit</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)]))))</a>
<a class="sourceLine" id="cb2-100" data-line-number="100">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb2-101" data-line-number="101">        ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(hyper_gamma_mu),</a>
<a class="sourceLine" id="cb2-102" data-line-number="102">                       <span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>)])) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-103" data-line-number="103"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-104" data-line-number="104">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb2-105" data-line-number="105">        ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(gamma_mu), </a>
<a class="sourceLine" id="cb2-106" data-line-number="106">                   <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit)<span class="op">$</span>grp<span class="op">+</span></a>
<a class="sourceLine" id="cb2-107" data-line-number="107"><span class="st">                              </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, <span class="dv">4</span>),<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit)<span class="op">$</span>grp[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>)]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-108" data-line-number="108"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-109" data-line-number="109">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb2-110" data-line-number="110">        ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(beta_j), </a>
<a class="sourceLine" id="cb2-111" data-line-number="111">                   <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit)<span class="op">$</span><span class="st">`</span><span class="dt">id:grp</span><span class="st">`</span><span class="op">+</span></a>
<a class="sourceLine" id="cb2-112" data-line-number="112"><span class="st">                              </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(beta_j)[<span class="dv">1</span>]),<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit)<span class="op">$</span><span class="st">`</span><span class="dt">id:grp</span><span class="st">`</span>[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>)]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-113" data-line-number="113"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-114" data-line-number="114">}</a>
<a class="sourceLine" id="cb2-115" data-line-number="115"><span class="co">#&gt; Loading...</span></a>
<a class="sourceLine" id="cb2-116" data-line-number="116"><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></a>
<a class="sourceLine" id="cb2-117" data-line-number="117"><span class="co">#&gt;   Approximation) [glmerMod]</span></a>
<a class="sourceLine" id="cb2-118" data-line-number="118"><span class="co">#&gt;  Family: binomial  ( logit )</span></a>
<a class="sourceLine" id="cb2-119" data-line-number="119"><span class="co">#&gt; Formula: y ~ 1 + condition + (1 + condition | grp/id)</span></a>
<a class="sourceLine" id="cb2-120" data-line-number="120"><span class="co">#&gt;    Data: dd</span></a>
<a class="sourceLine" id="cb2-121" data-line-number="121"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-122" data-line-number="122"><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></a>
<a class="sourceLine" id="cb2-123" data-line-number="123"><span class="co">#&gt;  96318.7  96459.8 -48144.4  96288.7    89985 </span></a>
<a class="sourceLine" id="cb2-124" data-line-number="124"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-125" data-line-number="125"><span class="co">#&gt; Scaled residuals: </span></a>
<a class="sourceLine" id="cb2-126" data-line-number="126"><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb2-127" data-line-number="127"><span class="co">#&gt; -5.5537 -0.6271 -0.2850  0.6748  5.9928 </span></a>
<a class="sourceLine" id="cb2-128" data-line-number="128"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-129" data-line-number="129"><span class="co">#&gt; Random effects:</span></a>
<a class="sourceLine" id="cb2-130" data-line-number="130"><span class="co">#&gt;  Groups Name        Variance Std.Dev. Corr       </span></a>
<a class="sourceLine" id="cb2-131" data-line-number="131"><span class="co">#&gt;  id:grp (Intercept) 1.2781   1.1306              </span></a>
<a class="sourceLine" id="cb2-132" data-line-number="132"><span class="co">#&gt;         condition2  1.7325   1.3163   -0.69      </span></a>
<a class="sourceLine" id="cb2-133" data-line-number="133"><span class="co">#&gt;         condition3  1.5496   1.2448   -0.66  0.56</span></a>
<a class="sourceLine" id="cb2-134" data-line-number="134"><span class="co">#&gt;  grp    (Intercept) 0.0547   0.2339              </span></a>
<a class="sourceLine" id="cb2-135" data-line-number="135"><span class="co">#&gt;         condition2  0.7732   0.8793   -0.19      </span></a>
<a class="sourceLine" id="cb2-136" data-line-number="136"><span class="co">#&gt;         condition3  0.4639   0.6811   -0.49 -0.65</span></a>
<a class="sourceLine" id="cb2-137" data-line-number="137"><span class="co">#&gt; Number of obs: 90000, groups:  id:grp, 300; grp, 4</span></a>
<a class="sourceLine" id="cb2-138" data-line-number="138"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-139" data-line-number="139"><span class="co">#&gt; Fixed effects:</span></a>
<a class="sourceLine" id="cb2-140" data-line-number="140"><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></a>
<a class="sourceLine" id="cb2-141" data-line-number="141"><span class="co">#&gt; (Intercept)  -1.2233     0.1319  -9.274  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb2-142" data-line-number="142"><span class="co">#&gt; condition2    0.8556     0.3979   2.150   0.0315 *  </span></a>
<a class="sourceLine" id="cb2-143" data-line-number="143"><span class="co">#&gt; condition3    2.0514     0.3217   6.377 1.81e-10 ***</span></a>
<a class="sourceLine" id="cb2-144" data-line-number="144"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb2-145" data-line-number="145"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb2-146" data-line-number="146"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-147" data-line-number="147"><span class="co">#&gt; Correlation of Fixed Effects:</span></a>
<a class="sourceLine" id="cb2-148" data-line-number="148"><span class="co">#&gt;            (Intr) cndtn2</span></a>
<a class="sourceLine" id="cb2-149" data-line-number="149"><span class="co">#&gt; condition2 -0.230       </span></a>
<a class="sourceLine" id="cb2-150" data-line-number="150"><span class="co">#&gt; condition3 -0.515 -0.547</span></a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/unnamed-chunk-2-1.png" width="700"><img src="test-simple-3l-mv-model_files/figure-html/unnamed-chunk-2-2.png" width="700"><img src="test-simple-3l-mv-model_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/pkg/future/man/resolved.html">resolved</a></span>(lme4_fit_2L_future)){</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">    lme4_fit_2L &lt;-<span class="st"> </span>future<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/future/man/value.html">value</a></span>(lme4_fit_2L_future)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(lme4_fit_2L))</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">        <span class="dt">means =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(dd, condition), <span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(y))[,<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">        <span class="dt">lme4_coef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)])),</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">        <span class="dt">lme4_p =</span> arm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/arm/man/invlogit.html">invlogit</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)]))))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">        ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(beta_j), </a>
<a class="sourceLine" id="cb3-10" data-line-number="10">                   <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit_2L)<span class="op">$</span><span class="st">`</span><span class="dt">id</span><span class="st">`</span><span class="op">+</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">                              </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(beta_j)[<span class="dv">1</span>]),<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit_2L)<span class="op">$</span>id[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>)]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; Loading...</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;   Approximation) [glmerMod]</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;  Family: binomial  ( logit )</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; Formula: y ~ 1 + condition + (1 + condition | id)</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;    Data: dd</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;  96575.2  96659.9 -48278.6  96557.2    89991 </span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; Scaled residuals: </span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; -5.8025 -0.6205 -0.2837  0.6769  6.0092 </span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; Random effects:</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt;  Groups Name        Variance Std.Dev. Corr       </span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt;  id     (Intercept) 1.332    1.154               </span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt;         condition2  2.595    1.611    -0.58      </span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt;         condition3  2.038    1.428    -0.61  0.20</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt; Number of obs: 90000, groups:  id, 300</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; Fixed effects:</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; (Intercept) -1.23053    0.06855 -17.951   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt; condition2   0.93459    0.09535   9.802   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt; condition3   2.02188    0.08524  23.721   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt; Correlation of Fixed Effects:</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt;            (Intr) cndtn2</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt; condition2 -0.585       </span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="co">#&gt; condition3 -0.615  0.225</span></a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/unnamed-chunk-2-4.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/pkg/future/man/resolved.html">resolved</a></span>(lme4_fit_2L_2rx_future)){</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    lme4_fit_2L_2rx &lt;-<span class="st"> </span>future<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/future/man/value.html">value</a></span>(lme4_fit_2L_2rx_future)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(lme4_fit_2L_2rx))</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">    <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">        <span class="dt">means =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(dd, condition), <span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(y))[,<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">        <span class="dt">lme4_coef =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L_2rx)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L_2rx)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L_2rx)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)])),</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">        <span class="dt">lme4_p =</span> arm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/arm/man/invlogit.html">invlogit</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L_2rx)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L_2rx)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/lme4/man/fixef.html">fixef</a></span>(lme4_fit_2L_2rx)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>)]))))</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">        ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(beta_j), </a>
<a class="sourceLine" id="cb4-11" data-line-number="11">                   <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit_2L_2rx)<span class="op">$</span><span class="st">`</span><span class="dt">id</span><span class="st">`</span><span class="op">+</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="st">                              </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(beta_j)[<span class="dv">1</span>]),<span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(lme4_fit_2L_2rx)<span class="op">$</span>id[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>)]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; Loading...</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;   Approximation) [glmerMod]</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;  Family: binomial  ( logit )</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; Formula: y ~ 1 + condition + (1 + condition | id) + (1 + condition | grp)</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;    Data: dd</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;  96318.7  96459.8 -48144.4  96288.7    89985 </span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; Scaled residuals: </span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; -5.5537 -0.6271 -0.2850  0.6748  5.9928 </span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; Random effects:</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt;  Groups Name        Variance Std.Dev. Corr       </span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt;  id     (Intercept) 1.2781   1.1306              </span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt;         condition2  1.7325   1.3163   -0.69      </span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;         condition3  1.5496   1.2448   -0.66  0.56</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt;  grp    (Intercept) 0.0547   0.2339              </span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt;         condition2  0.7732   0.8793   -0.19      </span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt;         condition3  0.4639   0.6811   -0.49 -0.65</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt; Number of obs: 90000, groups:  id, 300; grp, 4</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt; Fixed effects:</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt; (Intercept)  -1.2233     0.1319  -9.274  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt; condition2    0.8556     0.3979   2.150   0.0315 *  </span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt; condition3    2.0514     0.3217   6.377 1.81e-10 ***</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt; Correlation of Fixed Effects:</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48"><span class="co">#&gt;            (Intr) cndtn2</span></a>
<a class="sourceLine" id="cb4-49" data-line-number="49"><span class="co">#&gt; condition2 -0.230       </span></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="co">#&gt; condition3 -0.515 -0.547</span></a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/unnamed-chunk-2-5.png" width="700"></p>
<p>The Stan model that is being estimated is:</p>
<p><span class="math display">\[
\text{press_right}_{i} \sim \text{bernoulli_logit}(x_{i}\beta_{jj[i]}) \\
\beta_{j} \sim \mathcal{N}_{\text{mv}}(\delta_{mm[j]}, \Sigma_{\beta})  \\
\Sigma = \text{diag_matrix}(\tau) \Omega \text{diag_matrix}(\tau) \\
\tau_{k} \sim \text{Cauchy}(0, 2.5) \\
\Omega \sim \text{lkj_corr}(2)\\ 
\delta_{mk} \sim \mathcal{N} (\mu_{\delta k}, \sigma_{\delta})  \\
\mu_{\delta} \sim \mathcal{N} (0, 5) \\
\sigma_{\delta} \sim \text{exponential} (1)
\]</span></p>
<p>Where</p>
<ul>
<li>press_right is a binary indicator that the participant pressed the key on the right,</li>
<li>
<span class="math inline">\(x_{i}\)</span> is dummy coded for each trial’s condition,</li>
<li>
<span class="math inline">\(\beta_j\)</span> is a vector of subject-level (for subject <span class="math inline">\(jj[i]\)</span>) coefficients for all K conditions,</li>
<li>
<span class="math inline">\(\delta_m\)</span> is a vector of K means (again, per condition) for participant <span class="math inline">\(j\)</span>’s group <span class="math inline">\(mm[j]\)</span>,</li>
<li>
<span class="math inline">\(\Sigma_{\beta}\)</span> is the covariance matrix, optimized as recommended in the Stan manual via <span class="math inline">\(\tau\)</span> and <span class="math inline">\(\Omega\)</span>,</li>
<li>
<span class="math inline">\(\mu_{\delta}\)</span> is the population mean for each K condition,</li>
<li>and <span class="math inline">\(\sigma_{\delta}\)</span> is the scale parameter for the population means.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># data {</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="co"># int&lt;lower=1&gt; N; //number of subjects</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="co"># int&lt;lower=1&gt; T; //max number of trials</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="co"># int&lt;lower=2&gt; K; //number of trial predictors (in this case, conditions)</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="co"># int&lt;lower=1&gt; L; //number of subject-level predictors. 1 = intercept only</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="co"># int&lt;lower=1,upper=T&gt; Tsubj[N]; //trials per subject</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  <span class="co"># int&lt;lower=-1,upper=1&gt; press_right[N,T]; //choices "0" = left, "1" = right</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  <span class="co"># int&lt;lower=-1,upper=3&gt; condition[N,T]; //1 = ctrl, 2 = mateseeking, 3 = status</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="co"># matrix[N, L] u; //group predictors. u[,1] = 1 for intercept</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co"># }</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">press_right_mat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(dd<span class="op">$</span>y, <span class="dt">nrow =</span> j)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">condition_mat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(dd<span class="op">$</span>condition), <span class="dt">nrow =</span> j)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">data_for_stan &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">    <span class="dt">N =</span> j,</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">    <span class="dt">T =</span> t<span class="op">*</span>c,</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">    <span class="dt">K =</span> c,</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">    <span class="dt">M =</span> g,</a>
<a class="sourceLine" id="cb5-18" data-line-number="18">    <span class="dt">mm =</span> gg,</a>
<a class="sourceLine" id="cb5-19" data-line-number="19">    <span class="dt">Tsubj =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(t<span class="op">*</span><span class="dv">3</span>, j),</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">    <span class="dt">press_right =</span> press_right_mat,</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">    <span class="dt">condition =</span> condition_mat</a>
<a class="sourceLine" id="cb5-22" data-line-number="22">)</a>
<a class="sourceLine" id="cb5-23" data-line-number="23"></a>
<a class="sourceLine" id="cb5-24" data-line-number="24">stan_fit_fn.orig &lt;-<span class="st"> '/data/jflournoy/split/probly/stan_test_fit_c_l3.RDS'</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">stan_fit_fn.repar &lt;-<span class="st"> '/data/jflournoy/split/probly/stan_test_fit_non_c_l3.RDS'</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(stan_fit_fn.orig)){</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">    <span class="kw"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span>(multiprocess)</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">    stan_m_c &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stan_model.html">stan_model</a></span>(<span class="dt">file =</span> <span class="st">'../exec/splt_rl_mvnorm_test_c_l3.stan'</span>)</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">    stan_optim_c &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stanmodel-method-optimizing.html">optimizing</a></span>(stan_m_c,</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">                                    <span class="dt">data =</span> data_for_stan)</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">    <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(stan_optim_c<span class="op">$</span>par[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'delta'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_optim_c<span class="op">$</span>par))],<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">    stan_fit_test_c_f &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/future/man/future.html">future</a></span>({rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stan.html">stan</a></span>(<span class="dt">file =</span> <span class="st">'../exec/splt_rl_mvnorm_test_c_l3.stan'</span>,</a>
<a class="sourceLine" id="cb5-33" data-line-number="33">                                             <span class="dt">data =</span> data_for_stan, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">1500</span>,</a>
<a class="sourceLine" id="cb5-34" data-line-number="34">                                             <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">open_progress =</span> T)})</a>
<a class="sourceLine" id="cb5-35" data-line-number="35">    stan_fit_test_c &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/future/man/value.html">value</a></span>(stan_fit_test_c_f)</a>
<a class="sourceLine" id="cb5-36" data-line-number="36">    <span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(stan_fit_test_c, stan_fit_fn.orig)</a>
<a class="sourceLine" id="cb5-37" data-line-number="37">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb5-38" data-line-number="38">    stan_fit_test_c &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(stan_fit_fn.orig)</a>
<a class="sourceLine" id="cb5-39" data-line-number="39">}</a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(stan_fit_fn.repar)){</a>
<a class="sourceLine" id="cb5-41" data-line-number="41">    <span class="kw"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span>(multiprocess)</a>
<a class="sourceLine" id="cb5-42" data-line-number="42">    stan_m_nc &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stan_model.html">stan_model</a></span>(<span class="dt">file =</span> <span class="st">'../exec/splt_rl_mvnorm_test_non_c_l3.stan'</span>)</a>
<a class="sourceLine" id="cb5-43" data-line-number="43">    stan_optim_nc &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stanmodel-method-optimizing.html">optimizing</a></span>(stan_m_nc,</a>
<a class="sourceLine" id="cb5-44" data-line-number="44">                                    <span class="dt">data =</span> data_for_stan)</a>
<a class="sourceLine" id="cb5-45" data-line-number="45">    <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(stan_optim_nc<span class="op">$</span>par[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'delta'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_optim_nc<span class="op">$</span>par))],<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-46" data-line-number="46">    stan_fit_test_nc_f &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/future/man/future.html">future</a></span>({rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stan.html">stan</a></span>(<span class="dt">file =</span> <span class="st">'../exec/splt_rl_mvnorm_test_non_c_l3.stan'</span>,</a>
<a class="sourceLine" id="cb5-47" data-line-number="47">                                              <span class="dt">data =</span> data_for_stan, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">1500</span>,</a>
<a class="sourceLine" id="cb5-48" data-line-number="48">                                              <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">open_progress =</span> T)})</a>
<a class="sourceLine" id="cb5-49" data-line-number="49">    stan_fit_test_nc &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/future/man/value.html">value</a></span>(stan_fit_test_nc_f)</a>
<a class="sourceLine" id="cb5-50" data-line-number="50">    <span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(stan_fit_test_nc, stan_fit_fn.repar)</a>
<a class="sourceLine" id="cb5-51" data-line-number="51">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb5-52" data-line-number="52">    stan_fit_test_nc &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(stan_fit_fn.repar)</a>
<a class="sourceLine" id="cb5-53" data-line-number="53">}</a>
<a class="sourceLine" id="cb5-54" data-line-number="54"></a>
<a class="sourceLine" id="cb5-55" data-line-number="55">par_names.c &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'(delta|beta)'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_test_c), <span class="dt">value =</span> T)</a>
<a class="sourceLine" id="cb5-56" data-line-number="56">par_names.nc &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'(delta|beta)'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_test_nc), <span class="dt">value =</span> T)</a>
<a class="sourceLine" id="cb5-57" data-line-number="57">stan_fit_extract.c &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stanfit-method-extract.html">extract</a></span>(stan_fit_test_c, <span class="dt">pars =</span> par_names.c)</a>
<a class="sourceLine" id="cb5-58" data-line-number="58">stan_fit_extract.nc &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rstan/man/stanfit-method-extract.html">extract</a></span>(stan_fit_test_nc, <span class="dt">pars =</span> par_names.nc)</a>
<a class="sourceLine" id="cb5-59" data-line-number="59">bayesplot<span class="op">::</span><span class="kw"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mcmc_dens</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/array.html">as.array</a></span>(stan_fit_test_c), <span class="dt">regex_pars =</span> <span class="st">'mu_delta</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">d</span><span class="ch">\\</span><span class="st">]'</span>)</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">bayesplot<span class="op">::</span><span class="kw"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mcmc_dens</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/array.html">as.array</a></span>(stan_fit_test_nc), <span class="dt">regex_pars =</span> <span class="st">'mu_delta</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">d</span><span class="ch">\\</span><span class="st">]'</span>)</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-2.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">bayesplot<span class="op">::</span><span class="kw"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/array.html">as.array</a></span>(stan_fit_test_c), <span class="dt">regex_pars =</span> <span class="st">'mu_delta</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">d</span><span class="ch">\\</span><span class="st">]'</span>)</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-3.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">bayesplot<span class="op">::</span><span class="kw"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/array.html">as.array</a></span>(stan_fit_test_nc), <span class="dt">regex_pars =</span> <span class="st">'mu_delta</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">d</span><span class="ch">\\</span><span class="st">]'</span>)</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-4.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">stan_fit_c_means &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(stan_fit_extract.c, mean)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">stan_fit_nc_means &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(stan_fit_extract.nc, mean)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(beta_j),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                   <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                       stan_fit_c_means[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'beta</span><span class="ch">\\</span><span class="st">['</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_c_means))])) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-5.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">    ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(beta_j),</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                   <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                       stan_fit_nc_means[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'beta</span><span class="ch">\\</span><span class="st">['</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_nc_means))])) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-6.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">    ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(gamma_mu),</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                   <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">                       stan_fit_c_means[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'delta</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">d,'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_c_means))])) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-7.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">    ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(gamma_mu),</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">                   <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">                       stan_fit_nc_means[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'delta</span><span class="ch">\\</span><span class="st">[</span><span class="ch">\\</span><span class="st">d,'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_nc_means))])) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">        </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="test-simple-3l-mv-model_files/figure-html/test-stan-mvnorm-8.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="dt">stan =</span> stan_fit_c_means[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'mu_delta'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_c_means))],</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">      <span class="dt">raw_p =</span> arm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/arm/man/invlogit.html">logit</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(dd, condition), <span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(y))[,<span class="dv">2</span>])),</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">      <span class="dt">group_p =</span> <span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(gamma_mu, <span class="dv">2</span>, mean))</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt;         mu_delta[1] mu_delta[2] mu_delta[3]</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; stan    -1.190436   -0.3686154  0.836373   </span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; raw_p   -0.9823117  -0.2945104  0.6583961  </span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; group_p -1.227143   -0.4394004  0.7905008</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="dt">stan =</span> stan_fit_nc_means[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'mu_delta'</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(stan_fit_nc_means))],</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">      <span class="dt">raw_p =</span> arm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/arm/man/invlogit.html">logit</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(dd, condition), <span class="dt">mean =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(y))[,<span class="dv">2</span>])),</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">      <span class="dt">group_p =</span> <span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(gamma_mu, <span class="dv">2</span>, mean))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt;         mu_delta[1] mu_delta[2] mu_delta[3]</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; stan    -1.162693   -0.3534274  0.8202649  </span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; raw_p   -0.9823117  -0.2945104  0.6583961  </span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; group_p -1.227143   -0.4394004  0.7905008</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15">stan_fit_c_means<span class="op">$</span>sigma_delta</a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; [1] 0.8038438</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17">stan_fit_nc_means<span class="op">$</span>sigma_delta</a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt; [1] 0.8042396</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(stan_fit_test_c, <span class="dt">pars =</span> <span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'delta'</span>,par_names.c, <span class="dt">value =</span> T), <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">025</span>, <span class="fl">.5</span>, <span class="fl">.975</span>))<span class="op">$</span>summary</a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#&gt;                    mean     se_mean        sd        2.5%         50%</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">#&gt; mu_delta[1] -1.19043600 0.009609850 0.4103494 -2.00752410 -1.19217483</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="co">#&gt; mu_delta[2] -0.36861538 0.008711023 0.4082720 -1.22505029 -0.37287830</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="co">#&gt; mu_delta[3]  0.83637300 0.010086945 0.4155883  0.05159399  0.83590059</span></a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="co">#&gt; sigma_delta  0.80384382 0.006012827 0.2108235  0.50265092  0.76334216</span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">#&gt; delta[1,1]  -1.29003323 0.012168451 0.1278729 -1.53910172 -1.28924739</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="co">#&gt; delta[2,1]  -1.30984239 0.009878876 0.1351301 -1.57096298 -1.30849534</span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="co">#&gt; delta[3,1]  -0.75797525 0.009174405 0.1317907 -1.01197304 -0.76139865</span></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="co">#&gt; delta[4,1]  -1.48716536 0.009676619 0.1325258 -1.75646132 -1.48719736</span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"><span class="co">#&gt; delta[1,2]   1.06425176 0.006803405 0.1075503  0.83998079  1.06821022</span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="co">#&gt; delta[2,2]  -1.06330302 0.007809675 0.1228586 -1.30564928 -1.06457622</span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="co">#&gt; delta[3,2]  -0.45419537 0.011068580 0.1257497 -0.69478455 -0.45126109</span></a>
<a class="sourceLine" id="cb13-33" data-line-number="33"><span class="co">#&gt; delta[4,2]  -0.99447886 0.007971945 0.1184132 -1.22552953 -0.99331691</span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="co">#&gt; delta[1,3]  -0.05010475 0.007035527 0.1071256 -0.25501624 -0.05146253</span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="co">#&gt; delta[2,3]   0.74431965 0.008070989 0.1245280  0.49444595  0.73854894</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"><span class="co">#&gt; delta[3,3]   0.97109405 0.007389104 0.1112167  0.76175588  0.97077260</span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37"><span class="co">#&gt; delta[4,3]   1.65394947 0.006730866 0.1199622  1.41998688  1.65581808</span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="co">#&gt;                  97.5%     n_eff     Rhat</span></a>
<a class="sourceLine" id="cb13-39" data-line-number="39"><span class="co">#&gt; mu_delta[1] -0.3707453 1823.3686 1.002813</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40"><span class="co">#&gt; mu_delta[2]  0.4145897 2196.6501 1.001045</span></a>
<a class="sourceLine" id="cb13-41" data-line-number="41"><span class="co">#&gt; mu_delta[3]  1.6557548 1697.4906 1.001098</span></a>
<a class="sourceLine" id="cb13-42" data-line-number="42"><span class="co">#&gt; sigma_delta  1.3184927 1229.3644 1.001660</span></a>
<a class="sourceLine" id="cb13-43" data-line-number="43"><span class="co">#&gt; delta[1,1]  -1.0391111  110.4299 1.026023</span></a>
<a class="sourceLine" id="cb13-44" data-line-number="44"><span class="co">#&gt; delta[2,1]  -1.0501067  187.1065 1.001170</span></a>
<a class="sourceLine" id="cb13-45" data-line-number="45"><span class="co">#&gt; delta[3,1]  -0.5020760  206.3543 1.011909</span></a>
<a class="sourceLine" id="cb13-46" data-line-number="46"><span class="co">#&gt; delta[4,1]  -1.2296722  187.5659 1.017266</span></a>
<a class="sourceLine" id="cb13-47" data-line-number="47"><span class="co">#&gt; delta[1,2]   1.2622266  249.9024 1.011011</span></a>
<a class="sourceLine" id="cb13-48" data-line-number="48"><span class="co">#&gt; delta[2,2]  -0.8260618  247.4830 1.017098</span></a>
<a class="sourceLine" id="cb13-49" data-line-number="49"><span class="co">#&gt; delta[3,2]  -0.2081034  129.0715 1.025577</span></a>
<a class="sourceLine" id="cb13-50" data-line-number="50"><span class="co">#&gt; delta[4,2]  -0.7579529  220.6336 1.010884</span></a>
<a class="sourceLine" id="cb13-51" data-line-number="51"><span class="co">#&gt; delta[1,3]   0.1526026  231.8426 1.004511</span></a>
<a class="sourceLine" id="cb13-52" data-line-number="52"><span class="co">#&gt; delta[2,3]   1.0027901  238.0568 1.007483</span></a>
<a class="sourceLine" id="cb13-53" data-line-number="53"><span class="co">#&gt; delta[3,3]   1.1987591  226.5460 1.021901</span></a>
<a class="sourceLine" id="cb13-54" data-line-number="54"><span class="co">#&gt; delta[4,3]   1.8836240  317.6486 1.014358</span></a>
<a class="sourceLine" id="cb13-55" data-line-number="55"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(stan_fit_test_nc, <span class="dt">pars =</span> <span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">'delta'</span>,par_names.nc, <span class="dt">value =</span> T), <span class="dt">probs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">025</span>, <span class="fl">.5</span>, <span class="fl">.975</span>))<span class="op">$</span>summary</a>
<a class="sourceLine" id="cb13-56" data-line-number="56"><span class="co">#&gt;                       mean     se_mean        sd         2.5%         50%</span></a>
<a class="sourceLine" id="cb13-57" data-line-number="57"><span class="co">#&gt; mu_delta[1]    -1.16269273 0.018560900 0.3909543 -1.921430020 -1.17291204</span></a>
<a class="sourceLine" id="cb13-58" data-line-number="58"><span class="co">#&gt; mu_delta[2]    -0.35342743 0.021569488 0.4220587 -1.222371292 -0.33908163</span></a>
<a class="sourceLine" id="cb13-59" data-line-number="59"><span class="co">#&gt; mu_delta[3]     0.82026485 0.021207903 0.4154852  0.002475087  0.81519036</span></a>
<a class="sourceLine" id="cb13-60" data-line-number="60"><span class="co">#&gt; sigma_delta     0.80423959 0.009427298 0.2146855  0.500985535  0.76222704</span></a>
<a class="sourceLine" id="cb13-61" data-line-number="61"><span class="co">#&gt; delta_raw[1,1] -0.17332066 0.024226906 0.4962157 -1.141615488 -0.17300542</span></a>
<a class="sourceLine" id="cb13-62" data-line-number="62"><span class="co">#&gt; delta_raw[2,1] -0.19806005 0.023926037 0.5066053 -1.184894863 -0.20365825</span></a>
<a class="sourceLine" id="cb13-63" data-line-number="63"><span class="co">#&gt; delta_raw[3,1]  0.49234107 0.026845765 0.5292283 -0.539726178  0.48836849</span></a>
<a class="sourceLine" id="cb13-64" data-line-number="64"><span class="co">#&gt; delta_raw[4,1] -0.41767603 0.025843685 0.5074712 -1.426668662 -0.40875410</span></a>
<a class="sourceLine" id="cb13-65" data-line-number="65"><span class="co">#&gt; delta_raw[1,2]  1.87344300 0.029607839 0.6916709  0.545735634  1.86109362</span></a>
<a class="sourceLine" id="cb13-66" data-line-number="66"><span class="co">#&gt; delta_raw[2,2] -0.95714628 0.031046640 0.5810495 -2.087261079 -0.96042475</span></a>
<a class="sourceLine" id="cb13-67" data-line-number="67"><span class="co">#&gt; delta_raw[3,2] -0.16442341 0.027827607 0.5248824 -1.196405113 -0.16884929</span></a>
<a class="sourceLine" id="cb13-68" data-line-number="68"><span class="co">#&gt; delta_raw[4,2] -0.85334894 0.029999748 0.5598560 -1.942417786 -0.86572549</span></a>
<a class="sourceLine" id="cb13-69" data-line-number="69"><span class="co">#&gt; delta_raw[1,3] -1.16635987 0.028956949 0.5772055 -2.309412605 -1.16572935</span></a>
<a class="sourceLine" id="cb13-70" data-line-number="70"><span class="co">#&gt; delta_raw[2,3] -0.11593031 0.027200285 0.5133032 -1.144703974 -0.11131769</span></a>
<a class="sourceLine" id="cb13-71" data-line-number="71"><span class="co">#&gt; delta_raw[3,3]  0.19972561 0.029670061 0.5248678 -0.789251108  0.19482733</span></a>
<a class="sourceLine" id="cb13-72" data-line-number="72"><span class="co">#&gt; delta_raw[4,3]  1.08297439 0.026842785 0.5721005 -0.008156408  1.08077888</span></a>
<a class="sourceLine" id="cb13-73" data-line-number="73"><span class="co">#&gt; delta[1,1]     -1.30302100 0.011533961 0.1300011 -1.570785860 -1.30270619</span></a>
<a class="sourceLine" id="cb13-74" data-line-number="74"><span class="co">#&gt; delta[2,1]     -1.32292556 0.011156980 0.1419978 -1.596785537 -1.31461835</span></a>
<a class="sourceLine" id="cb13-75" data-line-number="75"><span class="co">#&gt; delta[3,1]     -0.79626986 0.017805602 0.1494726 -1.120883814 -0.78769049</span></a>
<a class="sourceLine" id="cb13-76" data-line-number="76"><span class="co">#&gt; delta[4,1]     -1.48819065 0.012059765 0.1272798 -1.726155344 -1.48449288</span></a>
<a class="sourceLine" id="cb13-77" data-line-number="77"><span class="co">#&gt; delta[1,2]      1.06436500 0.010597719 0.1156182  0.836098520  1.06652706</span></a>
<a class="sourceLine" id="cb13-78" data-line-number="78"><span class="co">#&gt; delta[2,2]     -1.07531380 0.010889620 0.1285082 -1.336286921 -1.07514393</span></a>
<a class="sourceLine" id="cb13-79" data-line-number="79"><span class="co">#&gt; delta[3,2]     -0.47523626 0.010234222 0.1207604 -0.708037366 -0.47760273</span></a>
<a class="sourceLine" id="cb13-80" data-line-number="80"><span class="co">#&gt; delta[4,2]     -0.99765519 0.010351628 0.1171438 -1.225488118 -0.99821446</span></a>
<a class="sourceLine" id="cb13-81" data-line-number="81"><span class="co">#&gt; delta[1,3]     -0.06408593 0.008503437 0.1085670 -0.280036197 -0.06438867</span></a>
<a class="sourceLine" id="cb13-82" data-line-number="82"><span class="co">#&gt; delta[2,3]      0.73036346 0.008036718 0.1183135  0.504117751  0.72644345</span></a>
<a class="sourceLine" id="cb13-83" data-line-number="83"><span class="co">#&gt; delta[3,3]      0.97218021 0.011398995 0.1240980  0.737036405  0.97051666</span></a>
<a class="sourceLine" id="cb13-84" data-line-number="84"><span class="co">#&gt; delta[4,3]      1.63862731 0.007815076 0.1183751  1.421051838  1.63574630</span></a>
<a class="sourceLine" id="cb13-85" data-line-number="85"><span class="co">#&gt;                      97.5%     n_eff      Rhat</span></a>
<a class="sourceLine" id="cb13-86" data-line-number="86"><span class="co">#&gt; mu_delta[1]    -0.36455101 443.66370 1.0022321</span></a>
<a class="sourceLine" id="cb13-87" data-line-number="87"><span class="co">#&gt; mu_delta[2]     0.50292445 382.88305 1.0076629</span></a>
<a class="sourceLine" id="cb13-88" data-line-number="88"><span class="co">#&gt; mu_delta[3]     1.68946098 383.80940 0.9992077</span></a>
<a class="sourceLine" id="cb13-89" data-line-number="89"><span class="co">#&gt; sigma_delta     1.32556907 518.59811 1.0094901</span></a>
<a class="sourceLine" id="cb13-90" data-line-number="90"><span class="co">#&gt; delta_raw[1,1]  0.81585166 419.51273 1.0008227</span></a>
<a class="sourceLine" id="cb13-91" data-line-number="91"><span class="co">#&gt; delta_raw[2,1]  0.80898873 448.33007 1.0014697</span></a>
<a class="sourceLine" id="cb13-92" data-line-number="92"><span class="co">#&gt; delta_raw[3,1]  1.56650393 388.62847 1.0039714</span></a>
<a class="sourceLine" id="cb13-93" data-line-number="93"><span class="co">#&gt; delta_raw[4,1]  0.57659683 385.57954 1.0088500</span></a>
<a class="sourceLine" id="cb13-94" data-line-number="94"><span class="co">#&gt; delta_raw[1,2]  3.28230814 545.73979 1.0048237</span></a>
<a class="sourceLine" id="cb13-95" data-line-number="95"><span class="co">#&gt; delta_raw[2,2]  0.18990517 350.26530 1.0138111</span></a>
<a class="sourceLine" id="cb13-96" data-line-number="96"><span class="co">#&gt; delta_raw[3,2]  0.86858851 355.77246 1.0093772</span></a>
<a class="sourceLine" id="cb13-97" data-line-number="97"><span class="co">#&gt; delta_raw[4,2]  0.25850845 348.27118 1.0084607</span></a>
<a class="sourceLine" id="cb13-98" data-line-number="98"><span class="co">#&gt; delta_raw[1,3] -0.03491447 397.33359 0.9999503</span></a>
<a class="sourceLine" id="cb13-99" data-line-number="99"><span class="co">#&gt; delta_raw[2,3]  0.85658033 356.12381 1.0002144</span></a>
<a class="sourceLine" id="cb13-100" data-line-number="100"><span class="co">#&gt; delta_raw[3,3]  1.21080203 312.94137 1.0039193</span></a>
<a class="sourceLine" id="cb13-101" data-line-number="101"><span class="co">#&gt; delta_raw[4,3]  2.21068176 454.24435 1.0014899</span></a>
<a class="sourceLine" id="cb13-102" data-line-number="102"><span class="co">#&gt; delta[1,1]     -1.04495529 127.03905 1.0353946</span></a>
<a class="sourceLine" id="cb13-103" data-line-number="103"><span class="co">#&gt; delta[2,1]     -1.04768055 161.98321 1.0225393</span></a>
<a class="sourceLine" id="cb13-104" data-line-number="104"><span class="co">#&gt; delta[3,1]     -0.51450487  70.47092 1.0344928</span></a>
<a class="sourceLine" id="cb13-105" data-line-number="105"><span class="co">#&gt; delta[4,1]     -1.24166774 111.38869 1.0692491</span></a>
<a class="sourceLine" id="cb13-106" data-line-number="106"><span class="co">#&gt; delta[1,2]      1.28610298 119.02210 1.0263070</span></a>
<a class="sourceLine" id="cb13-107" data-line-number="107"><span class="co">#&gt; delta[2,2]     -0.83775743 139.26309 1.0456529</span></a>
<a class="sourceLine" id="cb13-108" data-line-number="108"><span class="co">#&gt; delta[3,2]     -0.24210940 139.23218 1.0199574</span></a>
<a class="sourceLine" id="cb13-109" data-line-number="109"><span class="co">#&gt; delta[4,2]     -0.76762090 128.06237 1.0523552</span></a>
<a class="sourceLine" id="cb13-110" data-line-number="110"><span class="co">#&gt; delta[1,3]      0.14670704 163.00713 1.0255314</span></a>
<a class="sourceLine" id="cb13-111" data-line-number="111"><span class="co">#&gt; delta[2,3]      0.97308325 216.72600 1.0072571</span></a>
<a class="sourceLine" id="cb13-112" data-line-number="112"><span class="co">#&gt; delta[3,3]      1.20641255 118.52133 1.0371555</span></a>
<a class="sourceLine" id="cb13-113" data-line-number="113"><span class="co">#&gt; delta[4,3]      1.87519548 229.43210 1.0267197</span></a></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Flournoy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
